# CozyFantasyShooter

Я Константинов Алексей Сергеевич студент Skillbox
---
# __Управление игроком__ :

- Перемещение W,A,S,D
- прыжок Space
- Zoom  ПКМ
- Бросок G
- Выстрел ЛКМ
- Инвентарь I
- Взаимодействие E
  
  ---
  
# __Техническая документация__

---

## __Оглавление__
 Проект разделен на 5 системы 
- [MainSystem](#Main) <- отвечает за инициализацию проекта, точка входа 
- [WeaponSystem](#Weapon)  <- отвечает за вооружение
- [PlayerSystem](#PlayerSystem) <- отвечает за что связанно с игроком 
- [InventorySystem](#InventorySystem)<- отвечает за инвентарь и его отображение
- [UiSystem](#UiSystem)<- отвечает за отображение Ui Системы
  
---

## __MainSystem__
<a id="Main"></a>

__MainSystem__ 
: Главный скрипт , точка входа всего проекта, через него инициируются остальные скрипты.

> _В формате теста в нем реализован static event Action OnUpdate для использования единого Update в проекте. как я понимаю его фактическое пользы для оптимизации и использования на данный момент не имеет смысла из за размеров проекта_


---

## __WeaponSystem__ 
<b id="Weapon"></b>

__WeaponSystem__ 
: Это система инициирует и контролирует классы связанные с вооружением 

В частности :
- ChooseWeaponView  <- отвечает за отображение выбранного оружия , по мере его добавления 
- ShootingWeapon <- отвечает за реализацию стрельбы 
- ControlViewMark <- отвечает за следы попаданий 


---

### __ChooseWeaponView__

__ChooseWeaponView__ 
: Класс отвечает за отображение оружия при его смене по мере его добавления , оно создается на персонаже , и через этот класс контролируется , через включение и выключение модели

---

### __ShootingWeapon__ 

__ShootingWeapon__ 
: Класс отвечает за стрельбу  и инициализирует эффекты от оружия 
Для определения цели используется Raycast при нахождении цели с интерфейсом IHealtheble, ей наносится урон 


---

__WeaponEffect__ 
: Класс отвечающий за отображение эффектов от оружия , подписан на событие стрельбы , при активации срабатывают : 
Эффекты частиц , Анимации , Звуки , так же активирует следы от попаданий 

---

### __ControlViewMark__

__ControlViewMark__ 
: Класс отвечает за контроль и настройку отображения следов от пуль, так же в классе реализован потерн object pool , при инициализации класса создается заранее настроенное количество "следов" , при стрельбе этот класс предоставляет свободные метки для отображения .

> _Для лучшей производительности , создание меток происходит постепенно через Coroutine, с небольшой настраиваемой задержкой , так же реализована адаптивная механика увеличения количества следов при необходимости, их количество умножается в два раза от текущего._

 Подписывается на статическое событие класса MainSystem
( static event Action OnUpdate)
 В нем запускается его личное событие OnUpdateMark подписываясь на которое метки отсчитывают время своего таймера активности 

> _Не хватает механики завязанной на таймер, при отсутствии стрельбы какое-то количество времени , лишние следы удаляются , пока их количество не дойдет до базового значения_

---

#### __Mark__

__Mark__ 
: Класс отвечающий за след отображения выстрела . При инициализации получает значение через которое будет считаться не активным , при его установке подписывается на событие OnUpdateMark из класса ControlViewMark

> _Так же в целях оптимизации игровой объект не отключается , а только перестает отображаться , контролируется через MeshRenderer объекта_ 

---

## __PlayerSystem__
<c id="PlayerSystem"></c>

__PlayerSystem__ 
: Класс отвечающий за инициализацию всех скриптов игрока .

> _Он сделан не корректно относительно остальных систем , но данная оплошность обнаружена слишком поздно так что было принято решение оставить как есть.
>  В данный момент инициирует класс PlayerCharacter который уже в свою очередь выполняет роль PlayerSystem._

---

- IPlayerDatable <- отвечает за данные об игроке 
- PlayerMover <- отвечает за перемещение игрока
- PlayerLook <- отвечает за повороты , и работу с мышью
- PlayerAim <- отвечает за зум игрока 
- PlayerInteracteble <- отвечает за взаимодействие игрока с окружением



---
### __IPlayerDatable__

__IPlayerDatable__ 
: Это главный класс используемый во всем проекте , для получения данных об игроке 

- PlayerInventory <- отвечает за инвентарь игрока
- PlayerChooseWeapon <- отвечает за выбранное игроком оружие
- PlayerWeaponThrow <- отвечает за метательное оружие

---

#### __PlayerInventory__

__PlayerInventory__ 
: Это класс реализующий инвентарь игрока, он дает возможность добавить предмет в инвентарь после проверки , объединяется ли этот предмет со своими экземплярами и есть ли такой предмет в инвентаре, если нет ищется свободное место для для добавления предмета .
 Инвентарь состоит из слотов инвентаря 

> _Так же реализована механика поиска предметов в инвентаре через их уникальный Id номер , мы получаем доступ к слоту инвентаря через который мы взаимодействуем с предметами_



---

##### __SlotItem__

__SlotItem__
: Это класс реализует контроль занят ли слот , в зависимости от того есть ли в нем предмет, и взаимодействие с предметом

 При необходимости добавить или же отнять количество предметов в данном слоте сначала вызывается метод проверки количества предметов CheckChangeCountItem 
 Он определяет если после операции с количеством предметов , если их общее число после изменения >= 0 то он одобряет изменение
 Оно активируется методом ChangeCountItem, так же каждый SlotItem сам регулирует свое отображение в инвентаре путем использования метода 
 UpdateView, при получении предмета Инициирует его

---

##### __Item__

__Item__
: Это класс реализует базовый предмета

Обладает своей моделью , спрайтом, типом предмета , своим количеством и всем что может использоваться 

 При инициализации предметов используется ScriptableObject
 И при инициализации , которая происходит при подборе предмета данные из ScriptableObject заполняют Item 

---

##### __Weapon__

__Weapon__ 
: Базовый класс вооружения, наследник класса Item , так что обладает всеми его данными , и может храниться в инвентаре , в нем также хранятся данные и характеристики вооружения

 При своей инициализации Weapon попадает в скрипт PlayerChooseWeapon и добавляется в список оружий 

---

##### __BazeItem__

__BazeItem__ 
: Это ScriptableObject который отвечает за данные о предмете 


---

##### __BazeWeapon__

__BazeWeapon__ 
: Это ScriptableObject который отвечает за данные о Вооружении , наследник  BazeItem


---

#### __PlayerChooseWeapon__

__PlayerChooseWeapon__ 
: Это класс реализующий выбор оружия игрока .

 В нем представлено несколько слотов предметами , рассчитанного под определённый тип оружия , реализовано через списки

> _К примеру:_
_Первый слот отвечает за вооружения типа "Pistol" которое производит одиночный выстрел по нажатию кнопки стрельбы_

_Второй слот отвечает за вооружения типа "Stick" которое производит  выстрелы по зажатию и удержании кнопки стрельбы
Это позволяет в потенциале добавлять большое количество типов оружия_ 


_В одном слоте может находится несколько разных вариантов оружия одного типа  в бедующем при добавлении такого оружие переключение будет осуществляться через нажатие слота этого оружия_

> _Так же для переключения между слотами оружия используется кнопки этих слотов "1", "2" и кнопка смены активного слота оружия ">"_

---

#### __PlayerWeaponThrow__

__PlayerWeaponThrow__ 
: Это класс реализующий бросок предмета 
При инициализации предмета типа Grenade 
Он добавляется в список вооружения 


 _Если до этого вооружения не было оно экипируется_
 _При броске предмета мы используем вспомогательный класс WeaponThrowPool_ 
 _Он реализует паттерн object pool и создает фиксированное количество предметов при экипировке нового предмета , в целях оптимизации , при броске положение предмета обнуляется сбрасывается скорость и игрок его кидает , после броска предмет остается лежать на локации дожидаясь следующего броска_ 
 _Хранение созданных предметов осуществляется через словарь_ 
 _Dictionary<int, List GameObject> ключем к списку предметов является их ID_ 

> _Недостаёт метода отключения предмета после определенного количества времени_

---

### __PlayerMover__

__PlayerMover__ 
: Это класс реализующий перемещение игрока 

Используется New System Input , для получения значений ввода игрока 

> _При прыжке или нахождении в воздухе скорость перемещения по горизонтальной оси снижена в 4 раза_

---

### __PlayerLook__

__PlayerLook__ 
: Это класс реализующий перемещение взгляда игрока 

 Используется New System Input , для получения значений ввода игрока 

---

### __PlayerAim__

__PlayerAim__ 
: Это класс реализующий механику "зума"  приближения камеры , прицеливания ,

> _При прицеливании скорость перемещения снижена_

---

### __PlayerInteracteble__

__PlayerInteracteble__
: Класс реализующий взаимодействие игрока и игровым окружением 

С помощью Raycast мы отправляем луч на указанную дальность , ищем объекты находящиеся на физическом слое Interacteble , если на них есть скрипт реализующий интерфейс IInteracteble , и  мы взаимодействуем с ним через клавишу "E" то мы выполняем метод BaseInteract 

__PlayerUi__
: Класс отображающий игровую подсказку по нажатию клавиши , при нахождении предмета со скриптом реализующем интерфейс IInteracteble в зоне видимости 

---

## __InventorySystem__
<d id="InventorySystem"></d>

__InventorySystem__
: Отвечает за отображения инвентаря и его уведомлений при подборе предметов и за открытие и закрытие инвентаря

---

## __UiSystem__
<e id="UiSystem"></e>


__UiSystem__ 
: Отвечает за отображение экипированных предметов , вооружения и бросания с отображением их количества 

---

# __InputControl__

__InputControl__
: Единый скрипт обрабатывающий ввод игрока 
> _C целью не терять структуры размазывая весь код ввода по проекту было принято ращение концентрировать весь код ввода игрока в одном месте._

